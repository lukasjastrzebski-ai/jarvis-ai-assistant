# Jarvis Backend - Cloudflare Workers Configuration
# Copy to wrangler.toml and fill in your values
#
# Setup steps:
# 1. Install wrangler: npm install -g wrangler
# 2. Login: wrangler login
# 3. Create D1 database: wrangler d1 create jarvis-db
# 4. Copy the database_id to this file
# 5. Deploy: wrangler deploy

name = "jarvis-api"
main = "src/index.ts"
compatibility_date = "2024-01-01"

# Account ID from Cloudflare dashboard
account_id = "your-cloudflare-account-id"

# ============================================
# D1 DATABASE
# ============================================
# Create with: wrangler d1 create jarvis-db

[[d1_databases]]
binding = "DB"
database_name = "jarvis-db"
database_id = "your-d1-database-id"

# ============================================
# KV NAMESPACES (for caching)
# ============================================
# Create with: wrangler kv:namespace create "CACHE"

# [[kv_namespaces]]
# binding = "CACHE"
# id = "your-kv-namespace-id"

# ============================================
# ENVIRONMENT VARIABLES
# ============================================
# Non-secret config values

[vars]
ENVIRONMENT = "production"
LOG_LEVEL = "info"
CORS_ALLOWED_ORIGINS = "https://jarvis.yourcompany.com"

# ============================================
# SECRETS
# ============================================
# Set via: wrangler secret put SECRET_NAME
#
# Required secrets:
# - JWT_SECRET
# - GOOGLE_CLIENT_ID
# - GOOGLE_CLIENT_SECRET
# - OPENAI_API_KEY

# ============================================
# DEVELOPMENT ENVIRONMENT
# ============================================

[env.dev]
name = "jarvis-api-dev"
vars = { ENVIRONMENT = "development", LOG_LEVEL = "debug" }

[[env.dev.d1_databases]]
binding = "DB"
database_name = "jarvis-db-dev"
database_id = "your-dev-d1-database-id"

# ============================================
# STAGING ENVIRONMENT
# ============================================

[env.staging]
name = "jarvis-api-staging"
vars = { ENVIRONMENT = "staging", LOG_LEVEL = "info" }

[[env.staging.d1_databases]]
binding = "DB"
database_name = "jarvis-db-staging"
database_id = "your-staging-d1-database-id"

# ============================================
# ROUTES (Optional - for custom domains)
# ============================================

# routes = [
#   { pattern = "api.jarvis.yourcompany.com", custom_domain = true }
# ]

# ============================================
# BUILD SETTINGS
# ============================================

[build]
command = "npm run build"

# ============================================
# LIMITS
# ============================================

# Workers have default limits, but you can configure:
# - CPU time: 50ms (free), 30s (paid)
# - Memory: 128MB
# - Subrequests: 50 (free), 1000 (paid)
